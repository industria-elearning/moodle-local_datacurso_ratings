{"version":3,"file":"ratings_report.min.js","sources":["../src/ratings_report.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * TODO describe module get_ratings_report\n *\n * @module     local_datacurso_ratings/get_ratings_report\n * @copyright  2025 Industria Elearning <info@industriaelearning.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/* eslint-disable */\nimport Ajax from 'core/ajax';\n\nexport const init = () => {\n    const tbody = document.querySelector('#local-dcr-report-body');\n    const spinner = document.querySelector('.report-spinner');\n    const emptyMsg = document.querySelector('.report-empty');\n    const filterInput = document.querySelector('.report-filter');\n    const exportBtn = document.querySelector('.btn-export');\n\n    if (!tbody) {\n        return;\n    }\n\n    // Mostrar spinner\n    spinner.style.display = 'inline-block';\n\n    Ajax.call([{\n        methodname: 'local_datacurso_ratings_get_ratings_report',\n        args: {}\n    }])[0]\n        .then(data => {\n            spinner.style.display = 'none';\n            tbody.innerHTML = '';\n\n            if (!data || data.length === 0) {\n                emptyMsg.style.display = 'block';\n                return;\n            }\n\n            emptyMsg.style.display = 'none';\n\n            data.forEach(row => {\n                const tr = document.createElement('tr');\n                tr.innerHTML = `\n                    <td>${row.course}</td>\n                    <td>${row.activity}</td>\n                    <td>${row.likes}</td>\n                    <td>${row.dislikes}</td>\n                    <td>${row.approvalpercent}%</td>\n                    <td>${row.comments.join('</br>')}</td>\n                `;\n                tbody.appendChild(tr);\n            });\n\n            // --- Filtro ---\n            filterInput.addEventListener('input', () => {\n                const term = filterInput.value.toLowerCase();\n                tbody.querySelectorAll('tr').forEach(tr => {\n                    const text = tr.textContent.toLowerCase();\n                    tr.style.display = text.includes(term) ? '' : 'none';\n                });\n            });\n        })\n        .catch(err => {\n            spinner.style.display = 'none';\n            emptyMsg.style.display = 'block';\n            console.error(\"Error al traer data: \",err);\n        });\n};"],"names":["tbody","document","querySelector","spinner","emptyMsg","filterInput","style","display","call","methodname","args","then","data","innerHTML","length","forEach","row","tr","createElement","course","activity","likes","dislikes","approvalpercent","comments","join","appendChild","addEventListener","term","value","toLowerCase","querySelectorAll","text","textContent","includes","catch","err","console","error"],"mappings":";;;;;;;oJA0BoB,WACVA,MAAQC,SAASC,cAAc,0BAC/BC,QAAUF,SAASC,cAAc,mBACjCE,SAAWH,SAASC,cAAc,iBAClCG,YAAcJ,SAASC,cAAc,kBACzBD,SAASC,cAAc,eAEpCF,QAKLG,QAAQG,MAAMC,QAAU,6BAEnBC,KAAK,CAAC,CACPC,WAAY,6CACZC,KAAM,MACN,GACCC,MAAKC,OACFT,QAAQG,MAAMC,QAAU,OACxBP,MAAMa,UAAY,GAEbD,MAAwB,IAAhBA,KAAKE,QAKlBV,SAASE,MAAMC,QAAU,OAEzBK,KAAKG,SAAQC,YACHC,GAAKhB,SAASiB,cAAc,MAClCD,GAAGJ,8CACOG,IAAIG,iDACJH,IAAII,mDACJJ,IAAIK,gDACJL,IAAIM,mDACJN,IAAIO,2DACJP,IAAIQ,SAASC,KAAK,oCAE5BzB,MAAM0B,YAAYT,OAItBZ,YAAYsB,iBAAiB,SAAS,WAC5BC,KAAOvB,YAAYwB,MAAMC,cAC/B9B,MAAM+B,iBAAiB,MAAMhB,SAAQE,WAC3Be,KAAOf,GAAGgB,YAAYH,cAC5Bb,GAAGX,MAAMC,QAAUyB,KAAKE,SAASN,MAAQ,GAAK,cAxBlDxB,SAASE,MAAMC,QAAU,WA4BhC4B,OAAMC,MACHjC,QAAQG,MAAMC,QAAU,OACxBH,SAASE,MAAMC,QAAU,QACzB8B,QAAQC,MAAM,wBAAwBF"}